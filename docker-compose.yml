services:
  # Yaak Proxy Application
  yaak-proxy:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: yaak-proxy-app
    environment:
      # Database configuration
      DB_PATH: "/data/yaak.db"

      # Application configuration
      PROXY_PORT: ":8080"
      OPENAI_BASE_URL: "https://api.openai.com/v1"
      # Add your OpenAI API key here
      OPENAI_API_KEY: ${OPENAI_API_KEY}

      # PII Detector configuration
      DETECTOR_NAME: "onnx_model_detector" # or "regex_detector"

      # Logging configuration
      LOG_PII_CHANGES: "true"
      LOG_VERBOSE: "true"
      LOG_REQUESTS: "true"
      LOG_RESPONSES: "true"

      DB_CLEANUP_HOURS: "24"
    ports:
      - "8080:8080"
    volumes:
      - yaak_data:/data
    networks:
      - yaak-proxy-network
    restart: unless-stopped

volumes:
  yaak_data:
    driver: local

networks:
  yaak-proxy-network:
    driver: bridge
